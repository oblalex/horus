<!DOCTYPE html>
<html lang="en">
<html>
  <head>
    <title>Map Height Teller</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <style>
        body{
            margin: 0;
            padding: 0;
        }
        #map_height{
            display:none;
        }
        #result{
            margin: 10px;
        }
    </style>
    <script type="text/javascript">
        function GetH(R) {
            if (R < 64) return R;
            else if (R < 96) return 64 + (R - 64) * 2;
            else if (R < 128) return 128 + (R - 96) * 4;
            else if (R < 160) return 256 + (R - 128) * 8;
            else if (R < 192) return 512 + (R - 160) * 16;
            else if (R < 224) return 1024 + (R - 192) * 32;
            else return 2048 + (R - 224) * 64;
        }

        $(function() {

            var map_img = $("#map_main");
            var height_img = $("#map_height");
            var result_div = $("#result");

            var canvas = document.createElement('canvas');
            var context = canvas.getContext("2d");

            height_img.load(function(){
                canvas.width  = height_img.width();
                canvas.height = height_img.height();
                context.drawImage(height_img[0], 0, 0, height_img.width(), height_img.height());
            });

            map_img.click(function(e) {
                var offset = $(this).offset();
                var coord_x = e.clientX - offset.left;
                var coord_y = e.clientY - offset.top;

                var pixel = context.getImageData(coord_x/2, coord_y/2, 1, 1).data;

                result_div.text(
                    pixel[0] + ", "
                    + pixel[1] + ", "
                    + pixel[2] + " for ("
                    + coord_x + ";"
                    + coord_y + ") Alt: "
                    + GetH(pixel[0])
                );
            });
        });
    </script>
    </head>
    <body>
        <img src="Map.png" id="map_main"/>
        <img src="Map_height.png" id="map_height"/>
        <div id="result"></div>
    </body>
</html>
