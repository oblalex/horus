<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Horus-commander: src/bak/game_server.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Horus-commander
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/bak/game_server.h</div>  </div>
</div>
<div class="contents">
<a href="game__server_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef GAME_SERVER_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define GAME_SERVER_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;errno.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;signal.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;sys/stat.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;sys/wait.h&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;arpa/inet.h&gt;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;print_status.h&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;ini_helper.h&quot;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="game__server_8h.html#a26e9a63488c67c71c4a58b6526b98411">00020</a> <span class="preprocessor">#define GS_PATH PATH_PARENT PATH_SEP</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a><a class="code" href="game__server_8h.html#ae1bfab29e3f72f2c3b12af7dc4e2ae69">00022</a> <span class="preprocessor">#define GS_LOGS_DIR &quot;logs&quot; PATH_SEP</span>
<a name="l00023"></a><a class="code" href="game__server_8h.html#a47d2f4b3be4ef36345a394a5841838bc">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_LOGS_DIR_PATH GS_PATH GS_LOGS_DIR</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a><a class="code" href="game__server_8h.html#a1afbe6a9ee36e395b777ab1a5d350e84">00025</a> <span class="preprocessor">#define GS_LOG_STD &quot;sconsole&quot; FILE_EXT_LOG</span>
<a name="l00026"></a><a class="code" href="game__server_8h.html#ac834a0abacf1bd752c0e5af83b3110eb">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_LOG_STD_PATH GS_LOGS_DIR_PATH GS_LOG_STD</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a><a class="code" href="game__server_8h.html#a86d2d6846a518b245b2f80602cda45b9">00028</a> <span class="preprocessor">#define GS_LOG_ERR &quot;serrors&quot; FILE_EXT_LOG</span>
<a name="l00029"></a><a class="code" href="game__server_8h.html#ad7e31192aa803334aabb51ccf317188e">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_LOG_ERR_PATH GS_LOGS_DIR_PATH GS_LOG_ERR</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span>
<a name="l00031"></a><a class="code" href="game__server_8h.html#ab5840a23e5a65688e082999097dc12e3">00031</a> <span class="preprocessor">#define GS_LOG_EVT &quot;sevents&quot; FILE_EXT_LOG</span>
<a name="l00032"></a><a class="code" href="game__server_8h.html#a0598b2d62c6eb8b4b00af8d464b77816">00032</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_LOG_EVT_PATH_REL GS_LOGS_DIR GS_LOG_EVT</span>
<a name="l00033"></a><a class="code" href="game__server_8h.html#a46618aeafb897c89f059277a9438cde6">00033</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_LOG_EVT_PATH GS_PATH GS_LOG_EVT_PATH_REL</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a><a class="code" href="game__server_8h.html#a1de99d58b9d19e8a8dd3e60ef8b25543">00035</a> <span class="preprocessor">#define GS_NAME &quot;il2server&quot;</span>
<a name="l00036"></a><a class="code" href="game__server_8h.html#a76a6bc74a933f1767ca125410f4af7c7">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_EXE GS_NAME FILE_EXT_EXE</span>
<a name="l00037"></a><a class="code" href="game__server_8h.html#a3fc7fb0ea4f7a8e60f05992635ac9432">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_EXE_PATH GS_PATH GS_EXE</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00039"></a><a class="code" href="game__server_8h.html#aa06806326ee4efa2ab3e3fc8139ea999">00039</a> <span class="preprocessor">#define GS_OUT_REDIRECT &quot;&gt;&quot; GS_LOG_STD_PATH &quot; 2&gt;&quot; GS_LOG_ERR_PATH</span>
<a name="l00040"></a><a class="code" href="game__server_8h.html#ae4f2d2de84d1cff0823e7c9614f9fcd7">00040</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#ae4f2d2de84d1cff0823e7c9614f9fcd7">GS_START</a> = <span class="stringliteral">&quot;wine &quot;</span> <a class="code" href="game__server_8h.html#a3fc7fb0ea4f7a8e60f05992635ac9432">GS_EXE_PATH</a> <a class="code" href="game__server_8h.html#aa06806326ee4efa2ab3e3fc8139ea999">GS_OUT_REDIRECT</a>;
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="game__server_8h.html#a67ca3b599931ee382b7c328ff1987530">00042</a> <span class="preprocessor">#define GS_CFG &quot;confs&quot; FILE_EXT_INI</span>
<a name="l00043"></a><a class="code" href="game__server_8h.html#aca9f397cf9e15c9ae4b80d29d098f652">00043</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#aca9f397cf9e15c9ae4b80d29d098f652">GS_CFG_PATH</a> = <a class="code" href="game__server_8h.html#a26e9a63488c67c71c4a58b6526b98411">GS_PATH</a> <a class="code" href="game__server_8h.html#a67ca3b599931ee382b7c328ff1987530">GS_CFG</a>;
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="game__server_8h.html#a70453a2bd354a013f7e6a6b9658bb438">00045</a> <span class="preprocessor">#define GS_CMDF_MAIN &quot;server&quot; FILE_EXT_CMD</span>
<a name="l00046"></a><a class="code" href="game__server_8h.html#afa72357b71d6108e22eaff075610346c">00046</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#afa72357b71d6108e22eaff075610346c">GS_CMDF_MAIN_PATH</a> = <a class="code" href="game__server_8h.html#a26e9a63488c67c71c4a58b6526b98411">GS_PATH</a> <a class="code" href="game__server_8h.html#a70453a2bd354a013f7e6a6b9658bb438">GS_CMDF_MAIN</a>;
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="game__server_8h.html#a2d4ef2606d8d0f19c690efa035e4a08c">00048</a> <span class="preprocessor">#define GS_CMDF_GC &quot;gc&quot; FILE_EXT_CMD</span>
<a name="l00049"></a><a class="code" href="game__server_8h.html#a89cf193599de041fb4e83b729e6bfc0c">00049</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#a89cf193599de041fb4e83b729e6bfc0c">GS_CMDF_GC_PATH</a> = <a class="code" href="game__server_8h.html#a26e9a63488c67c71c4a58b6526b98411">GS_PATH</a> <a class="code" href="game__server_8h.html#a2d4ef2606d8d0f19c690efa035e4a08c">GS_CMDF_GC</a>;
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="game__server_8h.html#a158b2be9644a5e3607c622094414839c">00051</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#a158b2be9644a5e3607c622094414839c">GS_CONSOLE_PORT</a> = <span class="stringliteral">&quot;20001&quot;</span>;
<a name="l00052"></a><a class="code" href="game__server_8h.html#a3e646dc742359145b925d65a238e3ac6">00052</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#a3e646dc742359145b925d65a238e3ac6">GS_CONSOLE_CLIENT_ADDR</a> = <span class="stringliteral">&quot;127.0.0.1&quot;</span>;
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="game__server_8h.html#a9934b79c75adf46846197508ef414030">00054</a> <span class="preprocessor">#define GS_CMD_GC &quot;GC&quot;</span>
<a name="l00055"></a><a class="code" href="game__server_8h.html#a8453b6ca160d4586d1a4cc2a4872a729">00055</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_CMD_TIMEOUT(DELAY, CMD) &quot;timeout &quot; DELAY &quot; &quot; CMD</span>
<a name="l00056"></a><a class="code" href="game__server_8h.html#aa81193ad894c7139cd4574a789b7dda2">00056</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_CMD_RUN_FILE(FNAME) &quot;f &quot; FNAME</span>
<a name="l00057"></a><a class="code" href="game__server_8h.html#a538ff6902d2553f738992e8df5fe304f">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define GS_CMD_EXIT &quot;exit&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>
<a name="l00059"></a>00059 <span class="comment">// configuration sections names</span>
<a name="l00060"></a><a class="code" href="game__server_8h.html#a8b11fa786c8a297f774f7b0c6b0fa556">00060</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#a8b11fa786c8a297f774f7b0c6b0fa556">GS_CFG_CHAT</a>   = <span class="stringliteral">&quot;chat&quot;</span>;
<a name="l00061"></a><a class="code" href="game__server_8h.html#a588a1f65e4b467312192124415b1ac66">00061</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#a588a1f65e4b467312192124415b1ac66">GS_CFG_GAME</a>   = <span class="stringliteral">&quot;game&quot;</span>;
<a name="l00062"></a><a class="code" href="game__server_8h.html#a2808feedaecf02133a0b306faae67c7d">00062</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#a2808feedaecf02133a0b306faae67c7d">GS_CFG_CONSOLE</a> = <span class="stringliteral">&quot;Console&quot;</span>;
<a name="l00063"></a><a class="code" href="game__server_8h.html#ad3c5c8676125b3be2c505f92e717953c">00063</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> <a class="code" href="game__server_8h.html#ad3c5c8676125b3be2c505f92e717953c">GS_CFG_NET</a>    = <span class="stringliteral">&quot;NET&quot;</span>;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a46f7366555e54c69b73140a935436b3d">gs_start</a>();
<a name="l00066"></a>00066 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a2483317cd4847f8ec5714fc27afd58e3">gs_stop</a>();
<a name="l00067"></a>00067 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ae8316d80b1f58d97da2e0d4e1a0fda27">gs_stop_log_processor</a>();
<a name="l00068"></a>00068 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a8758a6e9624a2eefc440da8da192b17f">gs_exit_on_eror</a>(<span class="keywordtype">char</span>* err_msg);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a1571f764bf7be2b86128cbcdd969f0dd">gs_init</a>();
<a name="l00071"></a>00071 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a8afad9e811044ba39c8b7f88a07f156a">gs_descriptor_init</a>();
<a name="l00072"></a>00072 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab70a2c2d8ad3120c0652531094cd3cfe">gs_check_paths</a>();
<a name="l00073"></a>00073 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a0daa8534ddc291cac2da39ee3b6ccbfb">gs_check_path_root</a>();
<a name="l00074"></a>00074 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab779a9a9593ce6d37e9ba0a9919bc484">gs_check_path_logs</a>();
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#adca2d66c9e08bedd4e708256619aa65c">gs_check_settings</a>();
<a name="l00077"></a>00077 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a11e2d778601036043c2b6d9be3af6eee">gs_scripts_generate</a>();
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab99bc5dee5aa8b04bf0b8284234327b3">gs_config</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00080"></a>00080 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a00b6c6a28204b43ecb2716762329788e">gs_config_logging</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00081"></a>00081 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a210773ff3dec85ea25caaf429692ad9b">gs_config_logging_chat</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00082"></a>00082 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a5d98a039de004416cd1bd787c85f220a">gs_config_logging_console</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00083"></a>00083 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ad62ff3373ce2c12e1072c42e439a004f">gs_config_logging_file</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00084"></a>00084 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a31b861888b96563209b94096e1d82224">gs_config_console_connection</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00085"></a>00085 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a27db5769d5423757e733440bdc18b399">gs_config_version_checking</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a5f6afc4df97c05eedfedda65e9cb0ab0">gs_scripts_generate_gc</a>();
<a name="l00088"></a>00088 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a38361df0f68c86f81752bb3695fef909">gs_scripts_generate_main</a>();
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a52e9de083c7f79a34b0e6be1ffc084a9">gs_create_thread_and_wait_until_ready</a>(pthread_t* thread, <span class="keywordtype">void</span>*(*start_routine) (<span class="keywordtype">void</span>*));
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="keywordtype">void</span>* <a class="code" href="game__server_8h.html#ad05cfaffc9e17f70cfc16eaf5452ba94">gs_keep_process_running</a>();
<a name="l00093"></a>00093 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#abd66f6335557901981cd57413daa00bd">gs_create_process</a>();
<a name="l00094"></a>00094 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a70bffdb5d298fde23abd2cd75693d792">gs_wait_loaded</a>();
<a name="l00095"></a>00095 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a7c333970b2e87688ca3363abd7346b42">gs_wait_process</a>();
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="keywordtype">void</span>* <a class="code" href="game__server_8h.html#ab1482e33d4d08a31f43bcbcab712edec">gs_process_console</a>();
<a name="l00098"></a>00098 uint32_t <a class="code" href="game__server_8h.html#a96ba8ad920ae27bf4d351b45ab084c78">gs_get_local_address</a>();
<a name="l00099"></a>00099 <span class="keywordtype">int</span> <a class="code" href="game__server_8h.html#a2f6f1e46e65a400f3faaac470181b7f8">gs_console_readline</a>(<span class="keywordtype">char</span>* line);
<a name="l00100"></a>00100 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab63e1240fb21739d34d35353a21aca42">gs_process_console_line</a>(<span class="keywordtype">char</span>* line);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="keywordtype">void</span>* <a class="code" href="game__server_8h.html#aa87162922c02bdc679167a605acc8fe2">gs_process_log</a>();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#af67a9115ea4474ada51d802b1121eb57">gs_cmd_exit</a>();
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="structgs__descriptor.html">00106</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structgs__descriptor.html">gs_descriptor</a>
<a name="l00107"></a>00107 {
<a name="l00108"></a><a class="code" href="structgs__descriptor.html#a5bc7109d8479fdcb0222ff0363f883c0">00108</a>     pthread_t <a class="code" href="structgs__descriptor.html#a5bc7109d8479fdcb0222ff0363f883c0">process_keeper</a>;
<a name="l00109"></a><a class="code" href="structgs__descriptor.html#abe48ccaf0889ed75fc35d618fb98c9e6">00109</a>     pthread_t <a class="code" href="structgs__descriptor.html#abe48ccaf0889ed75fc35d618fb98c9e6">log_processor</a>;
<a name="l00110"></a><a class="code" href="structgs__descriptor.html#ad9450dcee5ee0c91396ca57af9d62633">00110</a>     pthread_t <a class="code" href="structgs__descriptor.html#ad9450dcee5ee0c91396ca57af9d62633">console_processor</a>;
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">00112</a>     pid_t <a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a>;
<a name="l00113"></a>00113 
<a name="l00114"></a><a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">00114</a>     <span class="keywordtype">int</span> <a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a>;
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="structgs__descriptor.html#ab959efef1e0bfe9ab57fe40561ebab89">00116</a>     <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18dd">BOOL</a> <a class="code" href="structgs__descriptor.html#ab959efef1e0bfe9ab57fe40561ebab89">run_process_keeper</a>;
<a name="l00117"></a><a class="code" href="structgs__descriptor.html#a353f22626c692c672fcf7397aa26659e">00117</a>     <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18dd">BOOL</a> <a class="code" href="structgs__descriptor.html#a353f22626c692c672fcf7397aa26659e">run_log_processor</a>;
<a name="l00118"></a><a class="code" href="structgs__descriptor.html#a29e02d4f65e724ee295911e621e45546">00118</a>     <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18dd">BOOL</a> <a class="code" href="structgs__descriptor.html#a29e02d4f65e724ee295911e621e45546">run_main</a>;
<a name="l00119"></a><a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">00119</a>     <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18dd">BOOL</a> <a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a>;
<a name="l00120"></a>00120 } <a class="code" href="game__server_8h.html#a7f8e2212ff0a8f720892ba8fda4b1a22">GSIPTOR</a>;
<a name="l00121"></a>00121 
<a name="l00122"></a><a class="code" href="game__server_8h.html#a324c5a60a1c6c317ce194d2e375ba6ce">00122</a> <a class="code" href="structgs__descriptor.html">GSIPTOR</a> <a class="code" href="game__server_8h.html#a324c5a60a1c6c317ce194d2e375ba6ce">GS</a>;
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="game__server_8h.html#a46f7366555e54c69b73140a935436b3d">00124</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a46f7366555e54c69b73140a935436b3d">gs_start</a>()
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126     <span class="keywordflow">if</span> (GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> &gt; (pid_t) 0)
<a name="l00127"></a>00127     {
<a name="l00128"></a>00128         <span class="keywordflow">return</span>;
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Starting game server&quot;</span>);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <a class="code" href="game__server_8h.html#a1571f764bf7be2b86128cbcdd969f0dd">gs_init</a>();
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <a class="code" href="game__server_8h.html#a52e9de083c7f79a34b0e6be1ffc084a9">gs_create_thread_and_wait_until_ready</a>(&amp;(GS.<a class="code" href="structgs__descriptor.html#a5bc7109d8479fdcb0222ff0363f883c0">process_keeper</a>), <a class="code" href="game__server_8h.html#ad05cfaffc9e17f70cfc16eaf5452ba94">gs_keep_process_running</a>);
<a name="l00136"></a>00136     <a class="code" href="game__server_8h.html#a52e9de083c7f79a34b0e6be1ffc084a9">gs_create_thread_and_wait_until_ready</a>(&amp;(GS.<a class="code" href="structgs__descriptor.html#ad9450dcee5ee0c91396ca57af9d62633">console_processor</a>), <a class="code" href="game__server_8h.html#ab1482e33d4d08a31f43bcbcab712edec">gs_process_console</a>);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="keywordtype">char</span>* msg = <span class="stringliteral">&quot;chat OLOLO\n&quot;</span>;
<a name="l00141"></a>00141     send(GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a>, msg, <span class="keyword">sizeof</span>(msg), 0);
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="game__server_8h.html#a52e9de083c7f79a34b0e6be1ffc084a9">00144</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a52e9de083c7f79a34b0e6be1ffc084a9">gs_create_thread_and_wait_until_ready</a>(pthread_t* thread, <span class="keywordtype">void</span>*(*start_routine) (<span class="keywordtype">void</span>*))
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146     GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00147"></a>00147     pthread_create(thread, NULL, start_routine, (<span class="keywordtype">void</span>*) NULL);
<a name="l00148"></a>00148     <span class="keywordflow">while</span>(GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> == <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>){
<a name="l00149"></a>00149         <a class="code" href="utils_8h.html#a65333954c7f5d13d24ded953560ccedb">waitMs</a>(0, 100);
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="game__server_8h.html#a2483317cd4847f8ec5714fc27afd58e3">00153</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a2483317cd4847f8ec5714fc27afd58e3">gs_stop</a>()
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155     <span class="keywordflow">if</span> (GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> &lt;= (pid_t) 0)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         <span class="keywordflow">return</span>;
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Stopping game server&quot;</span>);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     GS.<a class="code" href="structgs__descriptor.html#ab959efef1e0bfe9ab57fe40561ebab89">run_process_keeper</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <span class="keywordflow">if</span> (GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> == <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>){
<a name="l00164"></a>00164         <a class="code" href="game__server_8h.html#af67a9115ea4474ada51d802b1121eb57">gs_cmd_exit</a>();
<a name="l00165"></a>00165 
<a name="l00166"></a>00166         GS.<a class="code" href="structgs__descriptor.html#a29e02d4f65e724ee295911e621e45546">run_main</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168         <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Waiting for console processor to stop&quot;</span>);
<a name="l00169"></a>00169         pthread_join(GS.<a class="code" href="structgs__descriptor.html#ad9450dcee5ee0c91396ca57af9d62633">console_processor</a>, NULL);
<a name="l00170"></a>00170         <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00171"></a>00171     } <span class="keywordflow">else</span> {
<a name="l00172"></a>00172         <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Killing game server process&quot;</span>);
<a name="l00173"></a>00173         kill(GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a>, SIGSTOP);
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Waiting for game server process to stop&quot;</span>);
<a name="l00177"></a>00177     pthread_join(GS.<a class="code" href="structgs__descriptor.html#a5bc7109d8479fdcb0222ff0363f883c0">process_keeper</a>, NULL);
<a name="l00178"></a>00178     GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> = (pid_t) NULL;
<a name="l00179"></a>00179     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00184"></a><a class="code" href="game__server_8h.html#ae8316d80b1f58d97da2e0d4e1a0fda27">00184</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ae8316d80b1f58d97da2e0d4e1a0fda27">gs_stop_log_processor</a>()
<a name="l00185"></a>00185 {
<a name="l00186"></a>00186     GS.<a class="code" href="structgs__descriptor.html#a353f22626c692c672fcf7397aa26659e">run_log_processor</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00187"></a>00187     pthread_join(GS.<a class="code" href="structgs__descriptor.html#abe48ccaf0889ed75fc35d618fb98c9e6">log_processor</a>, NULL);
<a name="l00188"></a>00188 }
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="game__server_8h.html#a1571f764bf7be2b86128cbcdd969f0dd">00190</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a1571f764bf7be2b86128cbcdd969f0dd">gs_init</a>(){
<a name="l00191"></a>00191     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Initialization&quot;</span>);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     <a class="code" href="game__server_8h.html#a8afad9e811044ba39c8b7f88a07f156a">gs_descriptor_init</a>();
<a name="l00194"></a>00194     <a class="code" href="game__server_8h.html#ab70a2c2d8ad3120c0652531094cd3cfe">gs_check_paths</a>();
<a name="l00195"></a>00195     <a class="code" href="game__server_8h.html#adca2d66c9e08bedd4e708256619aa65c">gs_check_settings</a>();
<a name="l00196"></a>00196     <a class="code" href="game__server_8h.html#a11e2d778601036043c2b6d9be3af6eee">gs_scripts_generate</a>();
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="game__server_8h.html#a8afad9e811044ba39c8b7f88a07f156a">00201</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a8afad9e811044ba39c8b7f88a07f156a">gs_descriptor_init</a>()
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203     GS.<a class="code" href="structgs__descriptor.html#a29e02d4f65e724ee295911e621e45546">run_main</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00204"></a>00204     GS.<a class="code" href="structgs__descriptor.html#ab959efef1e0bfe9ab57fe40561ebab89">run_process_keeper</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00205"></a>00205     GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00206"></a>00206     GS.<a class="code" href="structgs__descriptor.html#a353f22626c692c672fcf7397aa26659e">run_log_processor</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208     GS.<a class="code" href="structgs__descriptor.html#a5bc7109d8479fdcb0222ff0363f883c0">process_keeper</a> = (pthread_t) NULL;
<a name="l00209"></a>00209     GS.<a class="code" href="structgs__descriptor.html#abe48ccaf0889ed75fc35d618fb98c9e6">log_processor</a> = (pthread_t) NULL;
<a name="l00210"></a>00210     GS.<a class="code" href="structgs__descriptor.html#ad9450dcee5ee0c91396ca57af9d62633">console_processor</a> = (pthread_t) NULL;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212     GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> = (pid_t) NULL;
<a name="l00213"></a>00213     GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a> = -1;
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="game__server_8h.html#ab70a2c2d8ad3120c0652531094cd3cfe">00216</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab70a2c2d8ad3120c0652531094cd3cfe">gs_check_paths</a>()
<a name="l00217"></a>00217 {
<a name="l00218"></a>00218     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Checking server&#39;s paths&quot;</span>);
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <a class="code" href="game__server_8h.html#a0daa8534ddc291cac2da39ee3b6ccbfb">gs_check_path_root</a>();
<a name="l00221"></a>00221     <a class="code" href="game__server_8h.html#ab779a9a9593ce6d37e9ba0a9919bc484">gs_check_path_logs</a>();
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a><a class="code" href="game__server_8h.html#a0daa8534ddc291cac2da39ee3b6ccbfb">00226</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a0daa8534ddc291cac2da39ee3b6ccbfb">gs_check_path_root</a>()
<a name="l00227"></a>00227 {
<a name="l00228"></a>00228     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Checking root path&quot;</span>);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     <span class="keywordflow">if</span> (access(<a class="code" href="game__server_8h.html#a3fc7fb0ea4f7a8e60f05992635ac9432">GS_EXE_PATH</a>, X_OK) != -1) {
<a name="l00231"></a>00231         <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00232"></a>00232     } <span class="keywordflow">else</span> {
<a name="l00233"></a>00233         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;Please, make sure in following:&quot;</span>);
<a name="l00234"></a>00234         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;1. This program is located in IL-2 server&#39;s subdirectory.&quot;</span>);
<a name="l00235"></a>00235         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;2. You are located at that directory currently.&quot;</span>);
<a name="l00236"></a>00236         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;3. IL-2 server&#39;s executable file is named as \&quot;&quot;</span> <a class="code" href="game__server_8h.html#a76a6bc74a933f1767ca125410f4af7c7">GS_EXE</a> <span class="stringliteral">&quot;\&quot;.&quot;</span>);
<a name="l00237"></a>00237         <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00238"></a>00238         exit(EXIT_FAILURE);
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240 }
<a name="l00241"></a>00241 
<a name="l00242"></a><a class="code" href="game__server_8h.html#ab779a9a9593ce6d37e9ba0a9919bc484">00242</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab779a9a9593ce6d37e9ba0a9919bc484">gs_check_path_logs</a>()
<a name="l00243"></a>00243 {
<a name="l00244"></a>00244     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Checking logs path&quot;</span>);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <span class="keyword">struct </span>stat st;
<a name="l00247"></a>00247     <span class="keywordtype">char</span>* path = <a class="code" href="game__server_8h.html#a47d2f4b3be4ef36345a394a5841838bc">GS_LOGS_DIR_PATH</a>;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="keywordflow">if</span> ((stat(path, &amp;st) != 0) &amp;&amp; (errno == ENOENT))
<a name="l00250"></a>00250     {
<a name="l00251"></a>00251         <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Creating missing directory&quot;</span>);
<a name="l00252"></a>00252         <span class="keywordflow">if</span> (mkdir(path, S_IRWXU) != 0)
<a name="l00253"></a>00253         {
<a name="l00254"></a>00254             <span class="keywordtype">char</span> err_msg[<span class="keyword">sizeof</span>(<a class="code" href="game__server_8h.html#a47d2f4b3be4ef36345a394a5841838bc">GS_LOGS_DIR_PATH</a>)+20+1];
<a name="l00255"></a>00255             strcpy (err_msg, <span class="stringliteral">&quot;Failed to create \&quot;&quot;</span>);
<a name="l00256"></a>00256             strcat (err_msg, path);
<a name="l00257"></a>00257             strcat (err_msg, <span class="stringliteral">&quot;\&quot;&quot;</span>);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259             <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(err_msg);
<a name="l00260"></a>00260             <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00261"></a>00261             exit(EXIT_FAILURE);
<a name="l00262"></a>00262         }
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a><a class="code" href="game__server_8h.html#adca2d66c9e08bedd4e708256619aa65c">00268</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#adca2d66c9e08bedd4e708256619aa65c">gs_check_settings</a>()
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Checking server&#39;s configuration&quot;</span>);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Loading configuration&quot;</span>);
<a name="l00273"></a>00273     <a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg = <a class="code" href="bak_2ini__helper_8h.html#abd1370c77650db587d77834ed5a96ce6">ini_start</a>((<span class="keywordtype">char</span>*)<a class="code" href="game__server_8h.html#aca9f397cf9e15c9ae4b80d29d098f652">GS_CFG_PATH</a>);
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keyword">const</span> <span class="keywordtype">char</span>* err_msg = NULL;
<a name="l00276"></a>00276 
<a name="l00277"></a>00277     <span class="keywordflow">while</span>(1)
<a name="l00278"></a>00278     {
<a name="l00279"></a>00279         <span class="keywordflow">if</span> (cfg == NULL) {
<a name="l00280"></a>00280             err_msg = <a class="code" href="bak_2ini__helper_8h.html#ac814bb2e035e73024293e6cb22f1f60e">INI_MALLOC_ERR_CONTAINER</a>;
<a name="l00281"></a>00281             <span class="keywordflow">break</span>;
<a name="l00282"></a>00282         }
<a name="l00283"></a>00283         <span class="keywordflow">if</span> ((err_msg = cfg-&gt;<a class="code" href="structini__container.html#a74775c3babf8abd8ba7c507f15441877">error_msg</a>) != NULL) <span class="keywordflow">break</span>;
<a name="l00284"></a>00284 
<a name="l00285"></a>00285         <a class="code" href="game__server_8h.html#ab99bc5dee5aa8b04bf0b8284234327b3">gs_config</a>(cfg);
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Saving configuration&quot;</span>);
<a name="l00288"></a>00288         <a class="code" href="bak_2ini__helper_8h.html#aba06175db26cd092e1cf40666b66d7d9">ini_end</a>(cfg);
<a name="l00289"></a>00289         err_msg = cfg-&gt;<a class="code" href="structini__container.html#a74775c3babf8abd8ba7c507f15441877">error_msg</a>;
<a name="l00290"></a>00290         <span class="keywordflow">break</span>;
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     <span class="keywordflow">if</span> (err_msg == NULL) {
<a name="l00294"></a>00294         <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00295"></a>00295     } <span class="keywordflow">else</span> {
<a name="l00296"></a>00296         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(err_msg);
<a name="l00297"></a>00297         <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00298"></a>00298         exit(EXIT_FAILURE);
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="game__server_8h.html#ab99bc5dee5aa8b04bf0b8284234327b3">00302</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab99bc5dee5aa8b04bf0b8284234327b3">gs_config</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304     <a class="code" href="game__server_8h.html#a00b6c6a28204b43ecb2716762329788e">gs_config_logging</a>(cfg);
<a name="l00305"></a>00305     <a class="code" href="game__server_8h.html#a31b861888b96563209b94096e1d82224">gs_config_console_connection</a>(cfg);
<a name="l00306"></a>00306     <a class="code" href="game__server_8h.html#a27db5769d5423757e733440bdc18b399">gs_config_version_checking</a>(cfg);
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="game__server_8h.html#a00b6c6a28204b43ecb2716762329788e">00309</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a00b6c6a28204b43ecb2716762329788e">gs_config_logging</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311     <a class="code" href="game__server_8h.html#a210773ff3dec85ea25caaf429692ad9b">gs_config_logging_chat</a>(cfg);
<a name="l00312"></a>00312     <a class="code" href="game__server_8h.html#a5d98a039de004416cd1bd787c85f220a">gs_config_logging_console</a>(cfg);
<a name="l00313"></a>00313     <a class="code" href="game__server_8h.html#ad62ff3373ce2c12e1072c42e439a004f">gs_config_logging_file</a>(cfg);
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="game__server_8h.html#a210773ff3dec85ea25caaf429692ad9b">00316</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a210773ff3dec85ea25caaf429692ad9b">gs_config_logging_chat</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Suppressing logging to chat&quot;</span>);
<a name="l00319"></a>00319     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a8b11fa786c8a297f774f7b0c6b0fa556">GS_CFG_CHAT</a>, <span class="stringliteral">&quot;autoLogDetail&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>);
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="game__server_8h.html#a5d98a039de004416cd1bd787c85f220a">00322</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a5d98a039de004416cd1bd787c85f220a">gs_config_logging_console</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Disabling console output saving to file&quot;</span>);
<a name="l00325"></a>00325     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a2808feedaecf02133a0b306faae67c7d">GS_CFG_CONSOLE</a>, <span class="stringliteral">&quot;LOG&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>);
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="game__server_8h.html#ad62ff3373ce2c12e1072c42e439a004f">00328</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ad62ff3373ce2c12e1072c42e439a004f">gs_config_logging_file</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Setting logging output file&quot;</span>);
<a name="l00331"></a>00331     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a588a1f65e4b467312192124415b1ac66">GS_CFG_GAME</a>, <span class="stringliteral">&quot;eventlog&quot;</span>, <a class="code" href="game__server_8h.html#a0598b2d62c6eb8b4b00af8d464b77816">GS_LOG_EVT_PATH_REL</a>);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Enabling log resetting for every mission&quot;</span>);
<a name="l00334"></a>00334     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a588a1f65e4b467312192124415b1ac66">GS_CFG_GAME</a>, <span class="stringliteral">&quot;eventlogkeep&quot;</span>, <span class="stringliteral">&quot;0&quot;</span>);
<a name="l00335"></a>00335 
<a name="l00336"></a>00336     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Enabling buildings destruction logging&quot;</span>);
<a name="l00337"></a>00337     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a588a1f65e4b467312192124415b1ac66">GS_CFG_GAME</a>, <span class="stringliteral">&quot;eventlogHouse&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="game__server_8h.html#a31b861888b96563209b94096e1d82224">00340</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a31b861888b96563209b94096e1d82224">gs_config_console_connection</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00341"></a>00341 {
<a name="l00342"></a>00342     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Setting console port&quot;</span>);
<a name="l00343"></a>00343     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a2808feedaecf02133a0b306faae67c7d">GS_CFG_CONSOLE</a>, <span class="stringliteral">&quot;IP&quot;</span>, <a class="code" href="game__server_8h.html#a158b2be9644a5e3607c622094414839c">GS_CONSOLE_PORT</a>);
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Setting console allowed client address&quot;</span>);
<a name="l00346"></a>00346     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#a2808feedaecf02133a0b306faae67c7d">GS_CFG_CONSOLE</a>, <span class="stringliteral">&quot;IPS&quot;</span>, <a class="code" href="game__server_8h.html#a3e646dc742359145b925d65a238e3ac6">GS_CONSOLE_CLIENT_ADDR</a>);
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="game__server_8h.html#a27db5769d5423757e733440bdc18b399">00349</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a27db5769d5423757e733440bdc18b399">gs_config_version_checking</a>(<a class="code" href="structini__container.html">INI_CONTAINER</a>* cfg)
<a name="l00350"></a>00350 {
<a name="l00351"></a>00351     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Setting client version checking&quot;</span>);
<a name="l00352"></a>00352     <a class="code" href="bak_2ini__helper_8h.html#aa96923ddfbe2573c4ff84a67a5ccfcef">ini_value_set</a>(cfg, <a class="code" href="game__server_8h.html#ad3c5c8676125b3be2c505f92e717953c">GS_CFG_NET</a>, <span class="stringliteral">&quot;checkRuntime&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>);
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00355"></a><a class="code" href="game__server_8h.html#a11e2d778601036043c2b6d9be3af6eee">00355</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a11e2d778601036043c2b6d9be3af6eee">gs_scripts_generate</a>()
<a name="l00356"></a>00356 {
<a name="l00357"></a>00357     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Generating server&#39;s scripts&quot;</span>);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359     <a class="code" href="game__server_8h.html#a5f6afc4df97c05eedfedda65e9cb0ab0">gs_scripts_generate_gc</a>();
<a name="l00360"></a>00360     <a class="code" href="game__server_8h.html#a38361df0f68c86f81752bb3695fef909">gs_scripts_generate_main</a>();
<a name="l00361"></a>00361 
<a name="l00362"></a>00362     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00363"></a>00363 }
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="game__server_8h.html#a5f6afc4df97c05eedfedda65e9cb0ab0">00365</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a5f6afc4df97c05eedfedda65e9cb0ab0">gs_scripts_generate_gc</a>()
<a name="l00366"></a>00366 {
<a name="l00367"></a>00367     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Generating garbage collecting script&quot;</span>);
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     FILE* f_gc = fopen (<a class="code" href="game__server_8h.html#a89cf193599de041fb4e83b729e6bfc0c">GS_CMDF_GC_PATH</a>, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00370"></a>00370     <span class="keywordflow">if</span> (f_gc == NULL)
<a name="l00371"></a>00371     {
<a name="l00372"></a>00372         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;Unable to create file \&quot;&quot;</span> <a class="code" href="game__server_8h.html#a2d4ef2606d8d0f19c690efa035e4a08c">GS_CMDF_GC</a> <span class="stringliteral">&quot;\&quot;&quot;</span>);
<a name="l00373"></a>00373         <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00374"></a>00374         exit(EXIT_FAILURE);
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377     fputs(<a class="code" href="game__server_8h.html#a9934b79c75adf46846197508ef414030">GS_CMD_GC</a> <span class="stringliteral">&quot;\n&quot;</span>, f_gc);
<a name="l00378"></a>00378     fputs(<a class="code" href="game__server_8h.html#a9934b79c75adf46846197508ef414030">GS_CMD_GC</a> <span class="stringliteral">&quot;\n&quot;</span>, f_gc);
<a name="l00379"></a>00379     fputs(<a class="code" href="game__server_8h.html#a9934b79c75adf46846197508ef414030">GS_CMD_GC</a> <span class="stringliteral">&quot;\n&quot;</span>, f_gc);
<a name="l00380"></a>00380     fputs(
<a name="l00381"></a>00381         <a class="code" href="game__server_8h.html#a8453b6ca160d4586d1a4cc2a4872a729">GS_CMD_TIMEOUT</a>(
<a name="l00382"></a>00382             <span class="stringliteral">&quot;3600000&quot;</span>,
<a name="l00383"></a>00383             <a class="code" href="game__server_8h.html#aa81193ad894c7139cd4574a789b7dda2">GS_CMD_RUN_FILE</a>(<a class="code" href="game__server_8h.html#a2d4ef2606d8d0f19c690efa035e4a08c">GS_CMDF_GC</a>)) <span class="stringliteral">&quot;\n&quot;</span>, f_gc);
<a name="l00384"></a>00384     fclose (f_gc);
<a name="l00385"></a>00385     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="game__server_8h.html#a38361df0f68c86f81752bb3695fef909">00388</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a38361df0f68c86f81752bb3695fef909">gs_scripts_generate_main</a>()
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Generating main script&quot;</span>);
<a name="l00391"></a>00391 
<a name="l00392"></a>00392     FILE* f_sys = fopen (<a class="code" href="game__server_8h.html#afa72357b71d6108e22eaff075610346c">GS_CMDF_MAIN_PATH</a>, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l00393"></a>00393     <span class="keywordflow">if</span> (f_sys == NULL)
<a name="l00394"></a>00394     {
<a name="l00395"></a>00395         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;Unable to create file \&quot;&quot;</span> <a class="code" href="game__server_8h.html#a70453a2bd354a013f7e6a6b9658bb438">GS_CMDF_MAIN</a> <span class="stringliteral">&quot;\&quot;&quot;</span>);
<a name="l00396"></a>00396         <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00397"></a>00397         exit(EXIT_FAILURE);
<a name="l00398"></a>00398     }
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     fputs (<a class="code" href="game__server_8h.html#aa81193ad894c7139cd4574a789b7dda2">GS_CMD_RUN_FILE</a>(<a class="code" href="game__server_8h.html#a2d4ef2606d8d0f19c690efa035e4a08c">GS_CMDF_GC</a>) <span class="stringliteral">&quot;\n&quot;</span>, f_sys);
<a name="l00401"></a>00401     fclose (f_sys);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a><a class="code" href="game__server_8h.html#ad05cfaffc9e17f70cfc16eaf5452ba94">00406</a> <span class="keywordtype">void</span>* <a class="code" href="game__server_8h.html#ad05cfaffc9e17f70cfc16eaf5452ba94">gs_keep_process_running</a>()
<a name="l00407"></a>00407 {
<a name="l00408"></a>00408     <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18dd">BOOL</a> was_launched_earlier = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00409"></a>00409     <span class="keywordtype">char</span>* gs_is_down_msg = <span class="stringliteral">&quot;Game server is shut down&quot;</span>;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411     <span class="keywordflow">while</span> (1) {
<a name="l00412"></a>00412         <span class="keywordflow">if</span> (was_launched_earlier == <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>)
<a name="l00413"></a>00413         {
<a name="l00414"></a>00414             <a class="code" href="bak_2print__status_8h.html#a70fed04f51823bf820982192bf2bfad9">PRINT_STATUS_MSG_NOIND</a>(<span class="stringliteral">&quot;Restarting game server&quot;</span>);
<a name="l00415"></a>00415             <a class="code" href="utils_8h.html#a65333954c7f5d13d24ded953560ccedb">waitMs</a>(2, 0);
<a name="l00416"></a>00416         }
<a name="l00417"></a>00417 
<a name="l00418"></a>00418         <a class="code" href="game__server_8h.html#abd66f6335557901981cd57413daa00bd">gs_create_process</a>();
<a name="l00419"></a>00419         <span class="keywordflow">if</span> (GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> &lt;= (pid_t) 0)
<a name="l00420"></a>00420         {
<a name="l00421"></a>00421             was_launched_earlier = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00422"></a>00422             <span class="keywordflow">continue</span>;
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         <a class="code" href="game__server_8h.html#a70bffdb5d298fde23abd2cd75693d792">gs_wait_loaded</a>();
<a name="l00426"></a>00426         <a class="code" href="game__server_8h.html#a7c333970b2e87688ca3363abd7346b42">gs_wait_process</a>();
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         <span class="keywordflow">if</span> (GS.<a class="code" href="structgs__descriptor.html#ab959efef1e0bfe9ab57fe40561ebab89">run_process_keeper</a> == <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>)
<a name="l00429"></a>00429         {
<a name="l00430"></a>00430             <a class="code" href="bak_2print__status_8h.html#a88cd1a6e4622ebb83bfeff05d9632df5">PRINT_STATUS_MSG_ERR_NOIND</a>(gs_is_down_msg);
<a name="l00431"></a>00431             was_launched_earlier = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00432"></a>00432         } <span class="keywordflow">else</span> {
<a name="l00433"></a>00433             <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(gs_is_down_msg);
<a name="l00434"></a>00434             <span class="keywordflow">break</span>;
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436     }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <span class="keywordflow">return</span> NULL;
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 
<a name="l00441"></a><a class="code" href="game__server_8h.html#abd66f6335557901981cd57413daa00bd">00441</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#abd66f6335557901981cd57413daa00bd">gs_create_process</a>()
<a name="l00442"></a>00442 {
<a name="l00443"></a>00443     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Creating game server process&quot;</span>);
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="keywordflow">if</span> ((GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> = fork()) &lt; 0)
<a name="l00446"></a>00446     {
<a name="l00447"></a>00447         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;Failed to fork&quot;</span>);
<a name="l00448"></a>00448         <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00449"></a>00449         <span class="keywordflow">return</span>;
<a name="l00450"></a>00450     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a> == 0) {
<a name="l00451"></a>00451         signal(SIGINT,  SIG_DFL);
<a name="l00452"></a>00452         signal(SIGKILL, SIG_DFL);
<a name="l00453"></a>00453         signal(SIGTERM, SIG_DFL);
<a name="l00454"></a>00454         signal(SIGABRT, SIG_DFL);
<a name="l00455"></a>00455         signal(SIGCHLD, SIG_DFL);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457         execl(<span class="stringliteral">&quot;/bin/sh&quot;</span>, <span class="stringliteral">&quot;sh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, <a class="code" href="game__server_8h.html#ae4f2d2de84d1cff0823e7c9614f9fcd7">GS_START</a>, (<span class="keywordtype">char</span>*) 0);
<a name="l00458"></a>00458         _exit(127);
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="game__server_8h.html#a70bffdb5d298fde23abd2cd75693d792">00464</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a70bffdb5d298fde23abd2cd75693d792">gs_wait_loaded</a>()
<a name="l00465"></a>00465 {
<a name="l00466"></a>00466     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Waiting for server is loaded&quot;</span>);
<a name="l00467"></a>00467 
<a name="l00468"></a>00468     <a class="code" href="utils_8h.html#a65333954c7f5d13d24ded953560ccedb">waitMs</a>(1, 0);
<a name="l00469"></a>00469 
<a name="l00470"></a>00470     FILE* f_log = fopen (<a class="code" href="game__server_8h.html#ac834a0abacf1bd752c0e5af83b3110eb">GS_LOG_STD_PATH</a>, <span class="stringliteral">&quot;rt&quot;</span>);
<a name="l00471"></a>00471     <span class="keywordflow">if</span> (f_log == NULL)
<a name="l00472"></a>00472     {
<a name="l00473"></a>00473         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(<span class="stringliteral">&quot;Unable to open server&#39;s output file \&quot;&quot;</span> <a class="code" href="game__server_8h.html#a1afbe6a9ee36e395b777ab1a5d350e84">GS_LOG_STD</a> <span class="stringliteral">&quot;\&quot;&quot;</span>);
<a name="l00474"></a>00474         <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00475"></a>00475         <a class="code" href="game__server_8h.html#a2483317cd4847f8ec5714fc27afd58e3">gs_stop</a>();
<a name="l00476"></a>00476         exit(EXIT_FAILURE);
<a name="l00477"></a>00477     }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="keywordtype">int</span> line_len = 70;
<a name="l00480"></a>00480     <span class="keywordtype">char</span> line[line_len];
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <span class="keywordflow">while</span>(GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> == <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>){
<a name="l00483"></a>00483         <span class="keywordflow">if</span> (fgets(line, line_len, f_log) == NULL)
<a name="l00484"></a>00484         {
<a name="l00485"></a>00485             <a class="code" href="utils_8h.html#a65333954c7f5d13d24ded953560ccedb">waitMs</a>(0, 300);
<a name="l00486"></a>00486         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strstr(line, <span class="stringliteral">&quot;1&gt;&quot;</span>) != NULL){
<a name="l00487"></a>00487             GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00488"></a>00488         }
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     fclose (f_log);
<a name="l00492"></a>00492     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00495"></a><a class="code" href="game__server_8h.html#a7c333970b2e87688ca3363abd7346b42">00495</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a7c333970b2e87688ca3363abd7346b42">gs_wait_process</a>()
<a name="l00496"></a>00496 {
<a name="l00497"></a>00497     <span class="keywordtype">int</span> childExitStatus;
<a name="l00498"></a>00498     waitpid(GS.<a class="code" href="structgs__descriptor.html#a892d538e91b793e932ba6e7a6a56c5db">pid</a>, &amp;childExitStatus, 0);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <span class="keywordflow">if</span>(WIFEXITED(childExitStatus) == 0)
<a name="l00501"></a>00501     {
<a name="l00502"></a>00502         <span class="keywordtype">char</span> err_msg [70];
<a name="l00503"></a>00503         sprintf (err_msg, <span class="stringliteral">&quot;waitpid() exited with an error. Status=%d&quot;</span>, WEXITSTATUS(childExitStatus));
<a name="l00504"></a>00504         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(err_msg);
<a name="l00505"></a>00505     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WIFSIGNALED(childExitStatus)) {
<a name="l00506"></a>00506         <span class="keywordtype">char</span> err_msg [60];
<a name="l00507"></a>00507         sprintf (err_msg, <span class="stringliteral">&quot;waitpid() exited due to a signal: %d&quot;</span>, WTERMSIG(childExitStatus));
<a name="l00508"></a>00508         <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(err_msg);
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa1e095cc966dbecf6a0d8aad75348d1a">FALSE</a>;
<a name="l00512"></a>00512 }
<a name="l00513"></a>00513 
<a name="l00514"></a><a class="code" href="game__server_8h.html#ab1482e33d4d08a31f43bcbcab712edec">00514</a> <span class="keywordtype">void</span>* <a class="code" href="game__server_8h.html#ab1482e33d4d08a31f43bcbcab712edec">gs_process_console</a>()
<a name="l00515"></a>00515 {
<a name="l00516"></a>00516     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Waiting for server&#39;s console processor to start&quot;</span>);
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="keywordflow">if</span>((GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a> = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0)
<a name="l00519"></a>00519     {
<a name="l00520"></a>00520         <a class="code" href="game__server_8h.html#a8758a6e9624a2eefc440da8da192b17f">gs_exit_on_eror</a>(<span class="stringliteral">&quot;Console socket creation failed&quot;</span>);
<a name="l00521"></a>00521     }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     <span class="keyword">struct </span>sockaddr_in addr;
<a name="l00524"></a>00524     addr.sin_family = AF_INET;
<a name="l00525"></a>00525     addr.sin_port = htons(atoi(<a class="code" href="game__server_8h.html#a158b2be9644a5e3607c622094414839c">GS_CONSOLE_PORT</a>));
<a name="l00526"></a>00526     addr.sin_addr.s_addr = htonl(<a class="code" href="game__server_8h.html#a96ba8ad920ae27bf4d351b45ab084c78">gs_get_local_address</a>());
<a name="l00527"></a>00527     
<a name="l00528"></a>00528     <span class="keywordflow">if</span>(connect(GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a>, (<span class="keyword">struct</span> sockaddr *)&amp;addr, <span class="keyword">sizeof</span>(addr)) &lt; 0)
<a name="l00529"></a>00529     {
<a name="l00530"></a>00530         <a class="code" href="game__server_8h.html#a8758a6e9624a2eefc440da8da192b17f">gs_exit_on_eror</a>(<span class="stringliteral">&quot;Console socket connection failed&quot;</span>);
<a name="l00531"></a>00531     } <span class="keywordflow">else</span> {
<a name="l00532"></a>00532         <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00533"></a>00533         GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00534"></a>00534     }
<a name="l00535"></a>00535     
<a name="l00536"></a>00536     <span class="keywordtype">char</span> line[256];
<a name="l00537"></a>00537     
<a name="l00538"></a>00538     <span class="keywordflow">while</span>(<a class="code" href="game__server_8h.html#a2f6f1e46e65a400f3faaac470181b7f8">gs_console_readline</a>(line) &gt; 0)
<a name="l00539"></a>00539     {
<a name="l00540"></a>00540         <a class="code" href="game__server_8h.html#ab63e1240fb21739d34d35353a21aca42">gs_process_console_line</a>(line);
<a name="l00541"></a>00541     }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543     close(GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a>);
<a name="l00544"></a>00544 
<a name="l00545"></a>00545     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Console processor stopped&quot;</span>);
<a name="l00546"></a>00546     <span class="keywordflow">return</span> NULL;
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="game__server_8h.html#ae9f5c8fccb04728582e40e156d5a0d9b">00549</a> <span class="preprocessor">#define GS_SERVER_ADDR_FILE &quot;server_addr&quot;</span>
<a name="l00550"></a>00550 <span class="preprocessor"></span>
<a name="l00551"></a><a class="code" href="game__server_8h.html#a96ba8ad920ae27bf4d351b45ab084c78">00551</a> uint32_t <a class="code" href="game__server_8h.html#a96ba8ad920ae27bf4d351b45ab084c78">gs_get_local_address</a>()
<a name="l00552"></a>00552 {
<a name="l00553"></a>00553     system(<span class="stringliteral">&quot;lsof -i | grep -m 1 &quot;</span> <a class="code" href="game__server_8h.html#a1de99d58b9d19e8a8dd3e60ef8b25543">GS_NAME</a> <span class="stringliteral">&quot; | awk &#39;{print $9}&#39; | awk -F: &#39;{print $1}&#39; &gt; &quot;</span> <a class="code" href="game__server_8h.html#ae9f5c8fccb04728582e40e156d5a0d9b">GS_SERVER_ADDR_FILE</a>);
<a name="l00554"></a>00554     FILE* f_addr = fopen (GS_SERVER_ADDR_FILE, <span class="stringliteral">&quot;rt&quot;</span>);
<a name="l00555"></a>00555     
<a name="l00556"></a>00556     <span class="keywordtype">int</span> line_len = 40;
<a name="l00557"></a>00557     <span class="keywordtype">char</span> line[line_len];
<a name="l00558"></a>00558     fgets(line, line_len, f_addr);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     fclose (f_addr);
<a name="l00561"></a>00561     system(<span class="stringliteral">&quot;rm &quot;</span> GS_SERVER_ADDR_FILE);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     <span class="keywordtype">int</span> len = strlen(line);
<a name="l00564"></a>00564     <span class="keywordflow">if</span>( line[len-1] == <span class="charliteral">&#39;\n&#39;</span> )
<a name="l00565"></a>00565         line[len-1] = 0;
<a name="l00566"></a>00566 
<a name="l00567"></a>00567     <span class="keywordflow">return</span> inet_network((<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;line);
<a name="l00568"></a>00568 }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570   
<a name="l00571"></a><a class="code" href="game__server_8h.html#a2f6f1e46e65a400f3faaac470181b7f8">00571</a> <span class="keywordtype">int</span> <a class="code" href="game__server_8h.html#a2f6f1e46e65a400f3faaac470181b7f8">gs_console_readline</a>(<span class="keywordtype">char</span>* line) 
<a name="l00572"></a>00572 {
<a name="l00573"></a>00573   <span class="keywordtype">int</span> line_len;
<a name="l00574"></a>00574   <span class="keywordtype">int</span> readcount;
<a name="l00575"></a>00575   <span class="keywordtype">char</span> c;
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="keywordflow">for</span> (line_len = 1; line_len &lt; <span class="keyword">sizeof</span>(line); line_len++)
<a name="l00578"></a>00578   {
<a name="l00579"></a>00579     readcount = read(GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a>, &amp;c, 1);
<a name="l00580"></a>00580     <span class="keywordflow">if</span> (readcount == 1)
<a name="l00581"></a>00581     {
<a name="l00582"></a>00582       *line = c;
<a name="l00583"></a>00583       line++;
<a name="l00584"></a>00584       <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;\n&#39;</span>)
<a name="l00585"></a>00585          <span class="keywordflow">break</span>;
<a name="l00586"></a>00586     } <span class="keywordflow">else</span> <span class="keywordflow">return</span> (-1);
<a name="l00587"></a>00587   }
<a name="l00588"></a>00588 
<a name="l00589"></a>00589   *line=0;
<a name="l00590"></a>00590   <span class="keywordflow">return</span> line_len;
<a name="l00591"></a>00591 }
<a name="l00592"></a>00592 
<a name="l00593"></a><a class="code" href="game__server_8h.html#ab63e1240fb21739d34d35353a21aca42">00593</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#ab63e1240fb21739d34d35353a21aca42">gs_process_console_line</a>(<span class="keywordtype">char</span>* line)
<a name="l00594"></a>00594 {
<a name="l00595"></a>00595     printf(line);
<a name="l00596"></a>00596 }
<a name="l00597"></a>00597 
<a name="l00598"></a><a class="code" href="game__server_8h.html#aa87162922c02bdc679167a605acc8fe2">00598</a> <span class="keywordtype">void</span>* <a class="code" href="game__server_8h.html#aa87162922c02bdc679167a605acc8fe2">gs_process_log</a>()
<a name="l00599"></a>00599 {
<a name="l00600"></a>00600     <a class="code" href="bak_2print__status_8h.html#a18717b11f755155190bfd921bea472df">PRINT_STATUS_NEW</a>(<span class="stringliteral">&quot;Waiting for server&#39;s log processor to start&quot;</span>);
<a name="l00601"></a>00601 
<a name="l00602"></a>00602     FILE* f_evt = fopen (<a class="code" href="game__server_8h.html#a46618aeafb897c89f059277a9438cde6">GS_LOG_EVT_PATH</a>, <span class="stringliteral">&quot;rt&quot;</span>);
<a name="l00603"></a>00603     <span class="keywordflow">if</span> (f_evt == NULL)
<a name="l00604"></a>00604     {
<a name="l00605"></a>00605         <a class="code" href="game__server_8h.html#a8758a6e9624a2eefc440da8da192b17f">gs_exit_on_eror</a>(<span class="stringliteral">&quot;Unable to open events log \&quot;&quot;</span> <a class="code" href="game__server_8h.html#ab5840a23e5a65688e082999097dc12e3">GS_LOG_EVT</a> <span class="stringliteral">&quot;\&quot;&quot;</span>);
<a name="l00606"></a>00606     }
<a name="l00607"></a>00607 
<a name="l00608"></a>00608     <span class="keywordtype">int</span> line_len = 100;
<a name="l00609"></a>00609     <span class="keywordtype">char</span> line[line_len];
<a name="l00610"></a>00610 
<a name="l00611"></a>00611     <span class="keywordflow">while</span>(fgets(line, line_len, f_evt) != NULL){}
<a name="l00612"></a>00612     
<a name="l00613"></a>00613     <a class="code" href="bak_2print__status_8h.html#abe2ed1f669a6f97bb744c7d9881d7111">PRINT_STATUS_DONE</a>();
<a name="l00614"></a>00614     GS.<a class="code" href="structgs__descriptor.html#aa5bd62da5d3416cc3f134d898f084192">ready</a> = <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>;
<a name="l00615"></a>00615 
<a name="l00616"></a>00616     <span class="keywordflow">while</span>(GS.<a class="code" href="structgs__descriptor.html#a353f22626c692c672fcf7397aa26659e">run_log_processor</a> == <a class="code" href="bak_2globals_8h.html#a3e5b8192e7d9ffaf3542f1210aec18ddaa82764c3079aea4e60c80e45befbb839">TRUE</a>){
<a name="l00617"></a>00617         <span class="keywordflow">if</span> (fgets(line, line_len, f_evt) == NULL)
<a name="l00618"></a>00618         {
<a name="l00619"></a>00619             <a class="code" href="utils_8h.html#a65333954c7f5d13d24ded953560ccedb">waitMs</a>(0, 300);
<a name="l00620"></a>00620         } <span class="keywordflow">else</span> {
<a name="l00621"></a>00621             <span class="comment">// TODO: parse event</span>
<a name="l00622"></a>00622             <span class="comment">// detect if mission stopped</span>
<a name="l00623"></a>00623             printf(line);
<a name="l00624"></a>00624         }
<a name="l00625"></a>00625     }
<a name="l00626"></a>00626 
<a name="l00627"></a>00627     fclose (f_evt);
<a name="l00628"></a>00628     <a class="code" href="bak_2print__status_8h.html#ad5125aa5beb01f9ea512525787244764">PRINT_STATUS_MSG</a>(<span class="stringliteral">&quot;Log processor stopped&quot;</span>);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630     <span class="keywordflow">return</span> NULL;
<a name="l00631"></a>00631 }
<a name="l00632"></a>00632 
<a name="l00633"></a><a class="code" href="game__server_8h.html#a8758a6e9624a2eefc440da8da192b17f">00633</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#a8758a6e9624a2eefc440da8da192b17f">gs_exit_on_eror</a>(<span class="keywordtype">char</span>* err_msg)
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635     <a class="code" href="bak_2print__status_8h.html#a42d2eea7bf745f6f3b09ede250037c6a">PRINT_STATUS_MSG_ERR</a>(err_msg);
<a name="l00636"></a>00636     <a class="code" href="bak_2print__status_8h.html#a577291b0bb3b700dbce6136646af7923">PRINT_STATUS_FAIL</a>();
<a name="l00637"></a>00637     <a class="code" href="game__server_8h.html#a2483317cd4847f8ec5714fc27afd58e3">gs_stop</a>();
<a name="l00638"></a>00638     exit(EXIT_FAILURE);
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00641"></a><a class="code" href="game__server_8h.html#af67a9115ea4474ada51d802b1121eb57">00641</a> <span class="keywordtype">void</span> <a class="code" href="game__server_8h.html#af67a9115ea4474ada51d802b1121eb57">gs_cmd_exit</a>()
<a name="l00642"></a>00642 {
<a name="l00643"></a>00643     <span class="keywordtype">char</span>* msg = <a class="code" href="game__server_8h.html#a538ff6902d2553f738992e8df5fe304f">GS_CMD_EXIT</a>;
<a name="l00644"></a>00644     send(GS.<a class="code" href="structgs__descriptor.html#a19037edb9ad910d48d07019cb7e843bc">console_socket</a>, msg, <span class="keyword">sizeof</span>(msg), 0);
<a name="l00645"></a>00645 }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 <span class="preprocessor">#endif // GAME_SERVER_H</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 30 2012 14:47:39 for Horus-commander by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
