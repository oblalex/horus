<html  
    t:pageTitle="${pageTitle}"
    t:type="layout"
    xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd">

    <style>
        #admin_item{
            padding: 5px 30px 15px 30px;
        }
        .admin_caption{
            font-size: 20px;
            font-weight: bold;
            float: left;
        }
        .admin_caption a{
            padding-left: 22px;
            outline: none;
            color: inherit;
            text-decoration: none;
            background: url('${context:img/controls/circle/circle_grey.png}');
        }
        .admin_caption a:hover{
            background: url('${context:img/controls/circle/circle_grey_hover.png}');
        }
        .admin_caption a, .admin_caption a:hover{
            background-repeat: no-repeat;
            background-position: 0 5px;
        }
        .admin_comment{
            text-indent: 22px;
            padding-left: 22px;
            font-size: 14px;
            text-align: justify;
        }        
        .typed_msg{
            margin: 5px;
        }
        .typed_msg_img_holder{
            float: left;
        }
        .typed_msg_body{
            background-color: rgba(250, 220, 0, 0.2);
            color: #540;
            vertical-align: top;
            border: 1px solid #A97;
            border-radius: 10px;
            padding: 10px;
            margin-left: 54px;
            min-height: 36px;
        }
        .typed_msg_body a{
            color:inherit;
            outline: none;
        }
        .crud_box{
            float: left;
            width: 50px;
            visibility: hidden;
        }        
    </style>

    <div class="content_hd">${pageTitle}</div>

    <t:if test="admins.empty">        
        <div class="typed_msg">
            <div class="typed_msg_img_holder">
                <img src="${context:img/msgtype/warning.png}"/>
            </div>
            <div class="typed_msg_body">
                ${message:admin.list.empty}
                <t:pagelink page="user/admin/init">${message:init.do}</t:pagelink>.
            </div>
        </div>
        <div class="clearer"></div>
    </t:if>
    <t:if test="!admins.empty">        
        <t:jquery.dialog t:clientId="dialogConfirm" title="${message:confirmation}">
            ${message:ask.action.confirm}<br/><br/>
            <div style="text-align: center;">
                <t:actionlink t:id="deleteItem" id="deleteItemLink" href="javascript:void;" context="-9999" class="a_simple">
                    <input type="button" class="horus_btn" value="${message:delete.do}"/>
                </t:actionlink>
                <a href="javascript:void;" class="a_simple" onClick="dialogConfirmClose();">
                    <input type="button" class="horus_btn" value="${message:cancel}"/>
                </a>
            </div>
        </t:jquery.dialog>
        <t:zone t:id="listZone" t:update="show" t:name="listZone">
            <t:loop source="admins" value="item">
                <div id="admin_item">
                    <div class="admin_caption_wrapper" id="${item.user.id}">
                        <div class="admin_caption">
                            <t:pagelink page="user/view" context="item.user.id">
                                ${item.user.login}
                            </t:pagelink>                    
                        </div>
                        <t:security.hasRole role="admin">
                            <div class="crud_box" id="cb${item.user.id}">
                                <t:if test="!itemPepresentsVisitor">
                                    <t:jquery.dialoglink t:dialog="dialogConfirm" onClick="setActionDeleteContext('${item.id}');">
                                        <div class="crud_delete16" title="${message:delete.do}"></div>
                                    </t:jquery.dialoglink>
                                </t:if>
                                <t:pagelink page="user/admin/modify" context="item.id">
                                    <div class="crud_edit16" title="${message:edit.do}"></div>
                                </t:pagelink>
                            </div>
                        </t:security.hasRole>
                        <div class="clearer"></div>
                    </div>
                    <div class="admin_comment">
                        ${item.comment}
                    </div>
                </div>
            </t:loop>
        </t:zone>
        <t:security.hasRole role="admin">
            <div style="text-align: center;">
                <t:pagelink page="user/admin/modify" class="a_simple">
                    <input type="button" class="horus_btn" value="${message:admin.list.add}"/>
                </t:pagelink>
            </div>
        </t:security.hasRole>
    </t:if>
    <script type="text/javascript">
        $(".admin_caption_wrapper").mouseenter(function() {
            $('#cb'+$(this).attr('id')).css('visibility','visible');
        });
        $(".admin_caption_wrapper").mouseleave(function() {
            $('#cb'+$(this).attr('id')).css('visibility','hidden');
        });
        function dialogConfirmClose(){
            $("#dialogConfirm").dialog("close");
        }
        function setActionDeleteContext(context){
            var link = $('#deleteItemLink');
            var linkHref = link.attr('href');
            link.attr('href', linkHref.slice(0, linkHref.lastIndexOf('/')+1)+context);
        }
    </script>
</html>
